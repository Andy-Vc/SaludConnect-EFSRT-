@using Web.Models.DTO
@{
	ViewData["Title"] = "Panel Principal";
	Layout = "~/Views/Shared/_LayoutPatient.cshtml";

	var nextAppointments = ViewBag.NextAppointments as List<PatientNextAppointements>;
}



<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
	<div>	
	<div class="mb-8">
		<h2 class="text-2xl font-semibold text-text-primary mb-2">Bienvenida, María</h2>
		<p class="text-text-secondary">Gestiona tus citas médicas de forma fácil y segura</p>
	</div>

	<section class="bg-surface rounded-lg shadow-md overflow-hidden mb-8">
		<div class="relative">
			<img src="https://images.pexels.com/photos/263402/pexels-photo-263402.jpeg?auto=compress&cs=tinysrgb&w=1200"
				 alt="Centro Médico MediCitas"
				 class="w-full h-64 object-cover">
			<div class="absolute inset-0 bg-primary bg-opacity-20"></div>
			<div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6">
				<h3 class="text-white text-xl font-semibold mb-2">Centro Médico MediCitas</h3>
				<p class="text-white text-sm opacity-90">Atención médica de calidad con tecnología avanzada</p>
			</div>
		</div>
		<div class="p-6">
			<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
				<div class="text-center">
					<div class="bg-primary-50 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3">
						<i class="fas fa-user-md text-primary text-lg"></i>
					</div>
					<h4 class="font-medium text-text-primary mb-1">Especialistas Certificados</h4>
					<p class="text-sm text-text-secondary">Más de 50 médicos especializados</p>
				</div>
				<div class="text-center">
					<div class="bg-accent-50 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3">
						<i class="fas fa-clock text-accent text-lg"></i>
					</div>
					<h4 class="font-medium text-text-primary mb-1">Horarios Flexibles</h4>
					<p class="text-sm text-text-secondary">Lunes a Sábado 7:00 - 18:00</p>
				</div>
				<div class="text-center">
					<div class="bg-success-50 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3">
						<i class="fas fa-shield-alt text-success text-lg"></i>
					</div>
					<h4 class="font-medium text-text-primary mb-1">Certificación ISO</h4>
					<p class="text-sm text-text-secondary">Calidad garantizada en atención</p>
				</div>
			</div>
		</div>
	</section>

	<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
		<div class="bg-surface rounded-lg shadow-md p-6 text-center">
			<div class="text-2xl font-bold text-primary mb-1">@ViewBag.TotalAppointments</div>
			<div class="text-sm text-text-secondary">Citas Totales</div>
		</div>
		<div class="bg-surface rounded-lg shadow-md p-6 text-center">
			<div class="text-2xl font-bold text-success mb-1">@ViewBag.ApointmentsAssisted</div>
			<div class="text-sm text-text-secondary">Completadas</div>
		</div>
		<div class="bg-surface rounded-lg shadow-md p-6 text-center">
			<div class="text-2xl font-bold text-warning mb-1">@ViewBag.ApointmentsEarring</div>
			<div class="text-sm text-text-secondary">Pendientes</div>
		</div>
		<div class="bg-surface rounded-lg shadow-md p-6 text-center">
			<div class="text-2xl font-bold text-error mb-1">@ViewBag.ApointmentsCanceled</div>
			<div class="text-sm text-text-secondary">Canceladas</div>
		</div>
	</div>

	<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

		<div class="lg:col-span-2">
			<div class="bg-surface rounded-lg shadow-md">

				<div class="p-6 border-b border-secondary-200">
					<div class="flex items-center justify-between">
						<h3 class="text-lg font-semibold text-text-primary">Próximas Citas</h3>
						<a class="text-primary text-sm hover:text-primary-700 transition-colors"
						   asp-controller="Pacient"
						   asp-action="Record">Ver todas</a>
					</div>
				</div>

				<div class="p-6 space-y-4">

					@if (nextAppointments != null && nextAppointments.Count > 0)
					{
						foreach (var cita in nextAppointments)
						{
							<div class="medical-card cursor-pointer"
									 onclick="window.location.href='@Url.Action("AppointmentsDetails", "Patient", new { idAppointment = cita.idAppointment })'">
								<div class="flex items-start space-x-4">
									<img src="https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop"
										 alt="@cita.nombresCompletos"
										 class="w-12 h-12 rounded-full object-cover">
									<div class="flex-1 min-w-0">
										<div class="flex items-center justify-between mb-2">
											<h4 class="text-sm font-medium text-text-primary">@cita.nameSpeciality</h4>

											@if (cita.state == "P")
											{
												<span class="status-warning">Pendiente</span>
											}
											else if (cita.state == "C")
											{
												<span class="status-success">Completada</span>
											}
											else
											{
												<span class="status-error">Cancelada</span>
											}
										</div>
										<p class="text-sm text-text-secondary mb-1">@cita.nombresCompletos</p>
										<div class="flex items-center text-xs text-text-secondary">
											<i class="far fa-calendar-alt mr-1"></i>
											<span>@cita.fechaCita</span>
											<i class="far fa-clock ml-3 mr-1"></i>
											<span>@cita.horaCita</span>
										</div>
									</div>
									<div class="flex-shrink-0">
										<i class="fas fa-chevron-right text-secondary-400"></i>
									</div>
								</div>
							</div>
						}
					}
					else
					{
						<div class="text-center py-4">
							<p class="text-sm text-text-secondary">ERROR AL CARGAR CITAS</p>
						</div>
					}

				</div>

				<div class="text-center py-4">
					<p class="text-sm text-text-secondary">No hay más citas programadas</p>
				</div>
			</div>
		</div>

			<div class="mt-6">
				<a asp-controller="Patient" asp-action="Booking"
				   class="btn-primary w-full md:w-auto text-center inline-block">
					<i class="fas fa-plus mr-2"></i>
					Programar Nueva Cita
				</a>
			</div>
	</div>

	<div class="space-y-6">

		<div class="bg-surface rounded-lg shadow-md p-6">
			<div class="flex items-center mb-4">
				<div class="bg-primary-50 rounded-full w-10 h-10 flex items-center justify-center mr-3">
					<i class="fas fa-user text-primary"></i>
				</div>
				<h3 class="text-lg font-medium text-text-primary">Mi Perfil</h3>
			</div>
			<p class="text-sm text-text-secondary mb-4">Actualiza tu información personal y de contacto</p>
			<a class="btn-secondary w-full text-center block"
			   asp-controller="Patient"
			   asp-action="Profile">
				Gestionar Perfil
			</a>
		</div>

		<div class="bg-surface rounded-lg shadow-md p-6">
			<div class="flex items-center mb-4">
				<div class="bg-accent-50 rounded-full w-10 h-10 flex items-center justify-center mr-3">
					<i class="fas fa-history text-accent"></i>
				</div>
				<h3 class="text-lg font-medium text-text-primary">Historial</h3>
			</div>
			<p class="text-sm text-text-secondary mb-4">Revisa todas tus citas médicas anteriores</p>
			<a class="btn-secondary w-full text-center block"
			   asp-controller="Patient"
			   asp-action="Record">
				Ver Historial
			</a>
		</div>

		<div class="bg-surface rounded-lg shadow-md p-6">
			<div class="flex items-center mb-4">
				<div class="bg-warning-50 rounded-full w-10 h-10 flex items-center justify-center mr-3">
					<i class="fas fa-bell text-warning"></i>
				</div>
				<div class="flex-1">
					<h3 class="text-lg font-medium text-text-primary">Notificaciones</h3>
					<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-error text-white">
						3 nuevas
					</span>
				</div>
			</div>
			<p class="text-sm text-text-secondary mb-4">Recordatorios y alertas importantes</p>
			<a class="btn-secondary w-full text-center block"
			   asp-controller="Notifications"
			   asp-action="Index">
				Ver Notificaciones
			</a>
		</div>

		<div class="bg-surface rounded-lg shadow-md p-6">
			<h3 class="text-lg font-medium text-text-primary mb-4">Actividad Reciente</h3>
			<div class="space-y-3">
				<div class="flex items-center text-sm">
					<div class="w-2 h-2 bg-success rounded-full mr-3"></div>
					<span class="text-text-secondary">Cita completada - Cardiología</span>
				</div>
				<div class="flex items-center text-sm">
					<div class="w-2 h-2 bg-primary rounded-full mr-3"></div>
					<span class="text-text-secondary">Recordatorio enviado</span>
				</div>
				<div class="flex items-center text-sm">
					<div class="w-2 h-2 bg-warning rounded-full mr-3"></div>
					<span class="text-text-secondary">Perfil actualizado</span>
				</div>
			</div>
		</div>
	</div>
	</div>
</main>

