
@{
    ViewData["Title"] = "Notifications";
    Layout = "~/Views/Shared/_LayoutPatient.cshtml";
}

<!-- Main Content -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Header Section -->
    <div class="mb-8">
        <div class="flex items-center justify-between">
            <div>
                <h2 class="text-2xl font-semibold text-text-primary mb-2">Centro de Notificaciones</h2>
                <p class="text-text-secondary">Gestiona todas tus alertas y recordatorios médicos</p>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Search Bar -->
                <div class="relative hidden md:block">
                    <input type="text" placeholder="Buscar notificaciones..." class="form-input pl-10 pr-4 py-2 w-64 text-sm" id="searchInput">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-secondary-400"></i>
                    </div>
                </div>
                <!-- Settings Button -->
                <button class="btn-secondary text-sm" onclick="toggleSettings()">
                    <i class="fas fa-cog mr-2"></i>
                    Configuración
                </button>
            </div>
        </div>
    </div>

    <!-- Filter Tabs -->
    <div class="mb-6">
        <div class="border-b border-secondary-200">
            <nav class="-mb-px flex space-x-8 overflow-x-auto">
                <button class="filter-tab active" data-filter="all" onclick="filterNotifications('all')">
                    <span>Todas</span>
                    <span class="notification-badge">6</span>
                </button>
                <button class="filter-tab" data-filter="reminders" onclick="filterNotifications('reminders')">
                    <span>Recordatorios</span>
                    <span class="notification-badge">5</span>
                </button>
                <button class="filter-tab" data-filter="confirmations" onclick="filterNotifications('confirmations')">
                    <span>Confirmaciones</span>
                    <span class="notification-badge">3</span>
                </button>
                <button class="filter-tab" data-filter="changes" onclick="filterNotifications('changes')">
                    <span>Cambios</span>
                    <span class="notification-badge">2</span>
                </button>
                <button class="filter-tab" data-filter="announcements" onclick="filterNotifications('announcements')">
                    <span>Anuncios</span>
                    <span class="notification-badge">2</span>
                </button>
            </nav>
        </div>
    </div>

    <!-- Bulk Actions -->
    <div class="mb-6 flex items-center justify-between">
        <div class="flex items-center space-x-4">
            <label class="flex items-center">
                <input type="checkbox" class="form-checkbox text-primary" id="selectAll" onchange="toggleSelectAll()">
                <span class="ml-2 text-sm text-text-secondary">Seleccionar todas</span>
            </label>
            <div class="hidden" id="bulkActions">
                <button class="btn-secondary text-sm mr-2" onclick="markSelectedAsRead()">
                    <i class="fas fa-check mr-1"></i>
                    Marcar como leídas
                </button>
                <button class="btn-secondary text-sm text-error" onclick="deleteSelected()">
                    <i class="fas fa-trash mr-1"></i>
                    Eliminar seleccionadas
                </button>
            </div>
        </div>
        <div class="text-sm text-text-secondary">
            <span id="unreadCount">3</span> notificaciones sin leer
        </div>
    </div>

    <!-- Notifications List -->
    <div class="space-y-4" id="notificationsList">
        <!-- Urgent Reminder Notification -->
        <div class="notification-card unread reminder" data-type="reminders">
            <div class="flex items-start space-x-4">
                <input type="checkbox" class="notification-checkbox form-checkbox text-primary mt-1">
                <div class="notification-icon urgent">
                    <i class="fas fa-exclamation-triangle text-warning"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-sm font-medium text-text-primary">Recordatorio Urgente - Cita en 1 hora</h4>
                        <div class="flex items-center space-x-2">
                            <span class="unread-indicator"></span>
                            <span class="text-xs text-text-secondary">11/10/2025 09:30</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">
                        Su cita con Dr. Carlos Mendoza (Cardiología) está programada para las 10:30.
                        Por favor, llegue 15 minutos antes con su documentación médica.
                    </p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2 text-xs text-text-secondary">
                            <i class="far fa-calendar-alt"></i>
                            <span>15/10/2025 - 10:30</span>
                            <i class="fas fa-map-marker-alt ml-2"></i>
                            <span>Consulta 205</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="text-primary text-xs hover:text-primary-700" onclick="viewAppointment('apt-001')">
                                Ver cita
                            </button>
                            <button class="text-text-secondary text-xs hover:text-text-primary" onclick="markAsRead(this)">
                                Marcar leída
                            </button>
                            <button class="text-error text-xs hover:text-red-700" onclick="deleteNotification(this)">
                                Eliminar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Confirmation Notification -->
        <div class="notification-card unread confirmation" data-type="confirmations">
            <div class="flex items-start space-x-4">
                <input type="checkbox" class="notification-checkbox form-checkbox text-primary mt-1">
                <div class="notification-icon success">
                    <i class="fas fa-check-circle text-success"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-sm font-medium text-text-primary">Cita Confirmada</h4>
                        <div class="flex items-center space-x-2">
                            <span class="unread-indicator"></span>
                            <span class="text-xs text-text-secondary">10/10/2025 16:45</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">
                        Su cita con Dra. Ana Rodríguez (Dermatología) ha sido confirmada exitosamente
                        para el 18/10/2025 a las 14:15.
                    </p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2 text-xs text-text-secondary">
                            <i class="far fa-calendar-alt"></i>
                            <span>18/10/2025 - 14:15</span>
                            <i class="fas fa-map-marker-alt ml-2"></i>
                            <span>Consulta 312</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="text-primary text-xs hover:text-primary-700" onclick="viewAppointment('apt-002')">
                                Ver cita
                            </button>
                            <button class="text-text-secondary text-xs hover:text-text-primary" onclick="markAsRead(this)">
                                Marcar leída
                            </button>
                            <button class="text-error text-xs hover:text-red-700" onclick="deleteNotification(this)">
                                Eliminar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Schedule Change Notification -->
        <div class="notification-card unread change" data-type="changes">
            <div class="flex items-start space-x-4">
                <input type="checkbox" class="notification-checkbox form-checkbox text-primary mt-1">
                <div class="notification-icon warning">
                    <i class="fas fa-clock text-warning"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-sm font-medium text-text-primary">Cambio de Horario</h4>
                        <div class="flex items-center space-x-2">
                            <span class="unread-indicator"></span>
                            <span class="text-xs text-text-secondary">09/10/2025 14:20</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">
                        Su cita con Dr. Luis Martín (Traumatología) ha sido reprogramada del
                        20/10/2025 15:00 al 22/10/2025 11:30 por disponibilidad del médico.
                    </p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2 text-xs text-text-secondary">
                            <i class="far fa-calendar-alt"></i>
                            <span>22/10/2025 - 11:30</span>
                            <i class="fas fa-map-marker-alt ml-2"></i>
                            <span>Consulta 108</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="text-primary text-xs hover:text-primary-700" onclick="viewAppointment('apt-003')">
                                Ver cita
                            </button>
                            <button class="text-text-secondary text-xs hover:text-text-primary" onclick="markAsRead(this)">
                                Marcar leída
                            </button>
                            <button class="text-error text-xs hover:text-red-700" onclick="deleteNotification(this)">
                                Eliminar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Announcement -->
        <div class="notification-card read announcement" data-type="announcements">
            <div class="flex items-start space-x-4">
                <input type="checkbox" class="notification-checkbox form-checkbox text-primary mt-1">
                <div class="notification-icon info">
                    <i class="fas fa-info-circle text-primary"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-sm font-medium text-text-primary">Nuevos Servicios Disponibles</h4>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs text-text-secondary">08/10/2025 10:15</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">
                        Ahora ofrecemos servicios de Telemedicina. Consulte con sus especialistas
                        desde la comodidad de su hogar. Disponible de lunes a viernes.
                    </p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2 text-xs text-text-secondary">
                            <i class="fas fa-video"></i>
                            <span>Consultas virtuales disponibles</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="text-primary text-xs hover:text-primary-700" onclick="learnMore()">
                                Más información
                            </button>
                            <button class="text-text-secondary text-xs hover:text-text-primary" onclick="markAsUnread(this)">
                                Marcar no leída
                            </button>
                            <button class="text-error text-xs hover:text-red-700" onclick="deleteNotification(this)">
                                Eliminar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Regular Reminder -->
        <div class="notification-card read reminder" data-type="reminders">
            <div class="flex items-start space-x-4">
                <input type="checkbox" class="notification-checkbox form-checkbox text-primary mt-1">
                <div class="notification-icon info">
                    <i class="fas fa-bell text-primary"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-sm font-medium text-text-primary">Recordatorio de Cita</h4>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs text-text-secondary">07/10/2025 09:00</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">
                        Recordatorio: Tiene una cita programada con Dr. Pedro Sánchez (Oftalmología)
                        mañana 12/10/2025 a las 16:00.
                    </p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2 text-xs text-text-secondary">
                            <i class="far fa-calendar-alt"></i>
                            <span>12/10/2025 - 16:00</span>
                            <i class="fas fa-map-marker-alt ml-2"></i>
                            <span>Consulta 401</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="text-primary text-xs hover:text-primary-700" onclick="viewAppointment('apt-004')">
                                Ver cita
                            </button>
                            <button class="text-text-secondary text-xs hover:text-text-primary" onclick="markAsUnread(this)">
                                Marcar no leída
                            </button>
                            <button class="text-error text-xs hover:text-red-700" onclick="deleteNotification(this)">
                                Eliminar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Update Notification -->
        <div class="notification-card read confirmation" data-type="confirmations">
            <div class="flex items-start space-x-4">
                <input type="checkbox" class="notification-checkbox form-checkbox text-primary mt-1">
                <div class="notification-icon success">
                    <i class="fas fa-check-circle text-success"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-sm font-medium text-text-primary">Perfil Actualizado</h4>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs text-text-secondary">05/10/2025 11:30</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">
                        Su información de perfil ha sido actualizada exitosamente.
                        Los cambios se reflejarán en sus próximas citas.
                    </p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2 text-xs text-text-secondary">
                            <i class="fas fa-user"></i>
                            <span>Información personal actualizada</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button class="text-primary text-xs hover:text-primary-700" onclick="viewProfile()">
                                Ver perfil
                            </button>
                            <button class="text-text-secondary text-xs hover:text-text-primary" onclick="markAsUnread(this)">
                                Marcar no leída
                            </button>
                            <button class="text-error text-xs hover:text-red-700" onclick="deleteNotification(this)">
                                Eliminar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load More Button -->
    <div class="text-center mt-8">
        <button class="btn-secondary" onclick="loadMoreNotifications()">
            <i class="fas fa-chevron-down mr-2"></i>
            Cargar más notificaciones
        </button>
    </div>
</main>

<!-- Settings Modal -->
<div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-surface rounded-lg shadow-lg max-w-md w-full p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-text-primary">Configuración de Notificaciones</h3>
                <button class="text-text-secondary hover:text-text-primary" onclick="toggleSettings()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="space-y-6">
                <div>
                    <h4 class="text-sm font-medium text-text-primary mb-3">Recordatorios de Citas</h4>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-primary" checked>
                            <span class="ml-2 text-sm text-text-secondary">1 hora antes</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-primary" checked>
                            <span class="ml-2 text-sm text-text-secondary">24 horas antes</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-primary">
                            <span class="ml-2 text-sm text-text-secondary">1 semana antes</span>
                        </label>
                    </div>
                </div>

                <div>
                    <h4 class="text-sm font-medium text-text-primary mb-3">Tipos de Notificaciones</h4>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-primary" checked>
                            <span class="ml-2 text-sm text-text-secondary">Confirmaciones de citas</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-primary" checked>
                            <span class="ml-2 text-sm text-text-secondary">Cambios de horario</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-primary" checked>
                            <span class="ml-2 text-sm text-text-secondary">Anuncios del sistema</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="flex justify-end space-x-3 mt-6">
                <button class="btn-secondary" onclick="toggleSettings()">Cancelar</button>
                <button class="btn-primary" onclick="saveSettings()">Guardar Cambios</button>
            </div>
        </div>
    </div>
</div>

<!-- Floating Help Button -->
<button class="fab" onclick="window.location.href='help_center.html'" title="Centro de Ayuda">
    <i class="fas fa-question text-lg"></i>
</button>