@using Web.Extensions
@{
	var user = Context?.Session?.GetObjectFromJson<User>("User");
	var initials = user != null
		? $"{user.FirstName?.FirstOrDefault()}{user.LastNamePat?.FirstOrDefault()}"
		: "??";
	var currentAction = ViewContext.RouteData.Values["action"]?.ToString();
	var currentController = ViewContext.RouteData.Values["controller"]?.ToString();
}
<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width" />
	<title>SaludConnect - @ViewBag.Title</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<style>
	.btn-outline-secondary.btn-sm:hover {
	border-color: #dc3545 !important;
	color: #fff !important;
	background-color: #dc3545 !important;
	}
</style>
<body>
	<nav class="navbar navbar-expand-lg bg-white border-bottom shadow-sm sticky-top" style="backdrop-filter: blur(8px);">
		<div class="container">
			<div class="d-flex w-100 align-items-center justify-content-between">

				<a class="navbar-brand d-flex align-items-center me-3" href="/">
					<div class="rounded-circle d-flex align-items-center justify-content-center me-2"
					style="width: 40px; height: 40px; background: linear-gradient(to right, #2563eb, #06b6d4);">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
						stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
						class="lucide lucide-heart text-white">
							<path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />
						</svg>
					</div>
					<span class="fw-bold text-dark h5 mb-0">SaludConnect</span>
				</a>

				<button class="navbar-toggler ms-auto d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#mainOffcanvas"
				aria-controls="mainOffcanvas" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse w-100 d-none d-lg-flex" id="mainNavbarDesktop">
					<div class="d-flex w-100 align-items-center justify-content-between">

						<ul class="navbar-nav mx-auto mb-2 mb-md-0 d-flex align-items-center gap-2">
							<li class="nav-item">
								<a class="nav-link @(currentAction == "Dashboard" && currentController == "Doctor"
								? "active bg-primary bg-opacity-10 text-primary"
								: "text-secondary hover:bg-light")
								rounded px-3 d-flex align-items-center gap-1"
								asp-action="Dashboard" asp-controller="Doctor">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house w-4 h-4" aria-hidden="true">
										<path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path>
										<path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
									</svg>
									Dashboard
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link @(currentAction == "Services" && currentController == "Doctor"
								? "active bg-primary bg-opacity-10 text-primary"
								: "text-secondary hover:bg-light")
								rounded px-3 d-flex align-items-center gap-1"
								asp-action="Services" asp-controller="Doctor">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-stethoscope w-4 h-4" aria-hidden="true">
										<path d="M11 2v2"></path>
										<path d="M5 2v2"></path>
										<path d="M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1"></path>
										<path d="M8 15a6 6 0 0 0 12 0v-3"></path>
										<circle cx="20" cy="10" r="2"></circle>
									</svg>
									Servicios
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link @(currentAction == "About" && currentController == "Doctor"
								 ? "active bg-primary bg-opacity-10 text-primary"
								 : "text-secondary hover:bg-light")
								 rounded px-3 d-flex align-items-center gap-1"
								asp-action="About" asp-controller="Doctor">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info w-4 h-4" aria-hidden="true">
										<circle cx="12" cy="12" r="10"></circle>
										<path d="M12 16v-4"></path>
										<path d="M12 8h.01"></path>
									</svg>
									Acerca de
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link @(currentAction == "Profile" && currentController == "Doctor"
								 ? "active bg-primary bg-opacity-10 text-primary"
								 : "text-secondary hover:bg-light")
								 rounded px-3 d-flex align-items-center gap-1"
								asp-action="Profile" asp-controller="Doctor">
									<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user w-4 h-4" aria-hidden="true">
										<path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
										<circle cx="12" cy="7" r="4"></circle>
									</svg>
									Mi Perfil
								</a>
							</li>
						</ul>

						<div class="d-flex align-items-center gap-3">
							<div class="d-flex align-items-center bg-light px-3 py-1 rounded-pill gap-2">
								@if (string.IsNullOrEmpty(user.ProfilePicture))
								{
									<div class="rounded-circle d-flex align-items-center justify-content-center"
									style="width: 32px; height: 32px; background: linear-gradient(to right, #3b82f6, #06b6d4);">
										<span class="text-white fw-medium small">@initials</span>
									</div>
								}
								else
								{
									<div class="rounded-circle d-flex align-items-center justify-content-center"
										 style="width: 32px; height: 32px; background: linear-gradient(to right, #3b82f6, #06b6d4); overflow: hidden;">
										<img id="profileImageLayout"
											 src="@user.ProfilePicture"
											 alt="Preview"
											 class="img-fluid rounded-circle"
											 style="width: 32px; height: 32px; object-fit: cover;">
									</div>

								}
								<div class="text-start">
									@if (user != null)
									{
										<div class="fw-medium text-dark">@user.FirstName @user.LastNamePat</div>

										<div class="text-muted small text-capitalize">
											@(
												user.Gender == "F" && user.Role.NameRole == "Doctor"
												? "Doctora"
												: user.Role.NameRole.ToLower()
											)
										</div>
									}

									else
									{
										<div class="fw-medium text-dark">Invitado</div>
										<div class="text-muted small text-capitalize">Sin rol</div>
									}
								</div>
							</div>
							<form asp-controller="UserAuth" asp-action="Logout" method="post" class="m-0">
								<button type="submit" class="btn btn-outline-secondary btn-sm d-flex align-items-center gap-1 border text-secondary">
									<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
										 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
										 class="lucide lucide-log-out">
										<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
										<polyline points="16 17 21 12 16 7" />
										<line x1="21" x2="9" y1="12" y2="12" />
									</svg>
									Cerrar Sesión
								</button>
							</form>
						</div>
					</div>
				</div>

			</div>
		</div>
	</nav>

	<div class="offcanvas offcanvas-end d-lg-none" tabindex="-1" id="mainOffcanvas" aria-labelledby="mainOffcanvasLabel">
		<div class="offcanvas-header bg-white border-bottom shadow-sm">
			<h5 class="offcanvas-title fw-bold text-dark" id="mainOffcanvasLabel">Menú SaludConnect</h5>
			<button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
		</div>
		<div class="offcanvas-body d-flex flex-column justify-content-between p-3">
			<ul class="navbar-nav mb-4 d-flex flex-column gap-2">
				<li class="nav-item">
					<a class="nav-link w-100 @(currentAction == "Dashboard" && currentController == "Doctor"
					? "active bg-primary bg-opacity-10 text-primary"
					: "text-secondary hover:bg-light")
					rounded px-3 py-2 d-flex align-items-center gap-2"
					   asp-action="Dashboard" asp-controller="Doctor">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house w-4 h-4" aria-hidden="true">
							<path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path>
							<path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
						</svg>
						Dashboard
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link w-100 @(currentAction == "Services" && currentController == "Doctor"
					? "active bg-primary bg-opacity-10 text-primary"
					: "text-secondary hover:bg-light")
					rounded px-3 py-2 d-flex align-items-center gap-2"
					   asp-action="Services" asp-controller="Doctor">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-stethoscope w-4 h-4" aria-hidden="true">
							<path d="M11 2v2"></path>
							<path d="M5 2v2"></path>
							<path d="M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1"></path>
							<path d="M8 15a6 6 0 0 0 12 0v-3"></path>
							<circle cx="20" cy="10" r="2"></circle>
						</svg>
						Servicios
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link w-100 @(currentAction == "About" && currentController == "Doctor"
					 ? "active bg-primary bg-opacity-10 text-primary"
					 : "text-secondary hover:bg-light")
					 rounded px-3 py-2 d-flex align-items-center gap-2"
					   asp-action="About" asp-controller="Doctor">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info w-4 h-4" aria-hidden="true">
							<circle cx="12" cy="12" r="10"></circle>
							<path d="M12 16v-4"></path>
							<path d="M12 8h.01"></path>
						</svg>
						Acerca de
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link w-100 @(currentAction == "Profile" && currentController == "Doctor"
					? "active bg-primary bg-opacity-10 text-primary"
					: "text-secondary hover:bg-light")
					rounded px-3 py-2 d-flex align-items-center gap-2"
					   asp-action="Profile" asp-controller="Doctor">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user w-4 h-4" aria-hidden="true">
							<path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
							<circle cx="12" cy="7" r="4"></circle>
						</svg>
						Mi Perfil
					</a>
				</li>
			</ul>

			<div class="mt-auto border-top pt-3">
				<div class="d-flex align-items-center bg-light px-3 py-2 rounded-pill gap-2 mb-3">
					@if (string.IsNullOrEmpty(user.ProfilePicture))
					{
						<div class="rounded-circle d-flex align-items-center justify-content-center"
							 style="width: 32px; height: 32px; background: linear-gradient(to right, #3b82f6, #06b6d4);">
							<span class="text-white fw-medium small">@initials</span>
						</div>
					}
					else
					{
						<div class="rounded-circle d-flex align-items-center justify-content-center"
							 style="width: 32px; height: 32px; background: linear-gradient(to right, #3b82f6, #06b6d4); overflow: hidden;">
							<img id="profileImageLayout"
								 src="@user.ProfilePicture"
								 alt="Preview"
								 class="img-fluid rounded-circle"
								 style="width: 32px; height: 32px; object-fit: cover;">
						</div>

					}
					<div class="text-start">
						@if (user != null)
						{
							<div class="fw-medium text-dark">@user.FirstName @user.LastNamePat</div>
							<div class="text-muted small text-capitalize">@user.Role.NameRole.ToLower()</div>
						}
						else
						{
							<div class="fw-medium text-dark">Invitado</div>
							<div class="text-muted small text-capitalize">Sin rol</div>
						}
					</div>
				</div>

				<form asp-controller="UserAuth" asp-action="Logout" method="post" class="m-0 w-100">
					<button type="submit" class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-center gap-1 border text-secondary">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
							 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
							 class="lucide lucide-log-out">
							<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
							<polyline points="16 17 21 12 16 7" />
							<line x1="21" x2="9" y1="12" y2="12" />
						</svg>
						Cerrar Sesión
					</button>
				</form>
			</div>
		</div>
	</div>

	<div>
		@RenderBody()
	</div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	@Html.Partial("_SweetAlert")
	@RenderSection("Scripts", required: false)
</body>
</html>
