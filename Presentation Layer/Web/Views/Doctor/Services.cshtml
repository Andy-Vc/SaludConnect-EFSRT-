@model IEnumerable<Web.Models.Service>
@{
	Layout = "~/Views/Shared/_LayoutDoctor.cshtml";
	ViewData["Title"] = "Servicios";

}
<div class="container-xl mt-3">
	<div class="mb-4">
		<h1 class="h3 fw-bold text-dark mb-2">Servicios Médicos</h1>
		<p class="text-secondary">
			Servicios integrales de salud proporcionados por nuestros experimentados profesionales médicos
		</p>
	</div>
	<div class="d-flex justify-content-center align-items-center" style="width: 400px;">
		<form method="get" class="d-flex justify-content-center align-items-center" style="width: 400px;">
			<div class="position-relative flex-grow-1 me-2">
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
					 class="position-absolute top-50 translate-middle-y text-muted"
					 style="left: 1rem; width: 1.25rem; height: 1.25rem;" aria-hidden="true">
					<path d="m21 21-4.34-4.34"></path>
					<circle cx="11" cy="11" r="8"></circle>
				</svg>
				<input id="searchInput" type="text"
					   class="form-control ps-5"
					   placeholder="Buscar servicios"
					   aria-label="Buscar servicios"
					   style="height: 3rem;"
					   oninput="filterServices()">
			</div>

			<a href="@Url.Action("Services", "Doctor")" class="btn btn-link p-0 ms-2 scale-2" title="Borrar búsqueda">
				<i class="fa-solid fa-eraser"></i>
			</a>
		</form>
	</div>

	<div class="row g-4 mt-3">
		<!-- Card 1 -->
		@foreach (var service in Model)
		{
			<div class="col-md-4 service-card"
				 data-name="@service.NameService.ToLower()"
				 data-description="@service.Description.ToLower()"
				 data-specialty="@service.Specialty.NameSpecialty.ToLower()">
				<div class="card shadow-sm rounded-3 bg-white bg-opacity-80 backdrop-blur">
					<div class="d-flex justify-content-between align-items-center p-3 border-0">
						<div class="rounded-circle d-flex justify-content-center align-items-center" style="width: 48px; height: 48px; background: linear-gradient(90deg, #3b82f6, #06b6d4); transition: transform 0.3s;">
							@{
								var nombre = service.Specialty.NameSpecialty?.ToLowerInvariant();
								if (nombre == "cardiología")
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
											 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
											 class="lucide lucide-heart w-6 h-6 text-white" aria-hidden="true">
											<path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
										</svg>
									</text>
								}
								else if (nombre == "dermatología")
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
											 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
											 class="lucide lucide-stethoscope w-6 h-6 text-white" aria-hidden="true">
											<path d="M11 2v2"></path>
											<path d="M5 2v2"></path>
											<path d="M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1"></path>
											<path d="M8 15a6 6 0 0 0 12 0v-3"></path>
											<circle cx="20" cy="10" r="2"></circle>
										</svg>
									</text>
								}
								else if (nombre == "neurología" || nombre == "psiquiatria")
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
											 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
											 class="lucide lucide-brain w-6 h-6 text-white" aria-hidden="true">
											<path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"></path>
											<path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"></path>
											<path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"></path>
											<path d="M17.599 6.5a3 3 0 0 0 .399-1.375"></path>
											<path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"></path>
											<path d="M3.477 10.896a4 4 0 0 1 .585-.396"></path>
											<path d="M19.938 10.5a4 4 0 0 1 .585.396"></path>
											<path d="M6 18a4 4 0 0 1-1.967-.516"></path>
											<path d="M19.967 17.484A4 4 0 0 1 18 18"></path>
										</svg>
									</text>
								}
								else if (nombre == "pediatría")
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
											 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
											 class="lucide lucide-baby w-6 h-6 text-white" aria-hidden="true">
											<path d="M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5"></path>
											<path d="M15 12h.01"></path>
											<path d="M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1"></path>
											<path d="M9 12h.01"></path>
										</svg>
									</text>
								}
								else if (nombre == "ortopedía")
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
											 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
											 class="lucide lucide-bone w-6 h-6 text-white" aria-hidden="true">
											<path d="M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z"></path>
										</svg>
									</text>
								}
								else if (nombre == "oftalmología")
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
											 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
											 class="lucide lucide-bone w-6 h-6 text-white" aria-hidden="true">
											<path d="M17 10c.7-.7 1.69 0 2.5 0a2.5 2.5 0 1 0 0-5 .5.5 0 0 1-.5-.5 2.5 2.5 0 1 0-5 0c0 .81.7 1.8 0 2.5l-7 7c-.7.7-1.69 0-2.5 0a2.5 2.5 0 0 0 0 5c.28 0 .5.22.5.5a2.5 2.5 0 1 0 5 0c0-.81-.7-1.8 0-2.5Z"></path>
										</svg>
									</text>
								}
								else if (nombre == "Medicina Interna")
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
											 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
											 class="lucide lucide-stethoscope w-6 h-6 text-white" aria-hidden="true">
											<path d="M11 2v2"></path>
											<path d="M5 2v2"></path>
											<path d="M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1"></path>
											<path d="M8 15a6 6 0 0 0 12 0v-3"></path>
											<circle cx="20" cy="10" r="2"></circle>
										</svg>
									</text>
								}
								else
								{
									<text>
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-alert-circle w-6 h-6 text-white" aria-hidden="true">
											<circle cx="12" cy="12" r="10"></circle>
											<line x1="12" y1="8" x2="12" y2="12"></line>
											<line x1="12" y1="16" x2="12" y2="16"></line>
										</svg>
									</text>
								}
							}
						</div>
						<span class="badge bg-info text-dark fw-semibold px-3 py-1">@service.Specialty.NameSpecialty</span>
					</div>
					<div class="px-3 mb-3">
						<h5 class="card-title text-dark fw-bold">@service.NameService</h5>
						<p class="card-text text-secondary small">@service.Description</p>
					</div>
					<div class="px-3 d-flex justify-content-between text-secondary small mb-3">
						<div class="d-flex align-items-center">
							<svg xmlns="http://www.w3.org/2000/svg"
								 width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
								 stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock w-4 h-4 me-2"
								 aria-hidden="true">
								<circle cx="12" cy="12" r="10"></circle>
								<polyline points="12 6 12 12 16 14"></polyline>
							</svg>
							<span>@service.DurationMinutes minutos</span>
						</div>
						<div class="d-flex align-items-center fw-semibold">
							<span>MXN @service.Price</span>
						</div>
					</div>
				</div>
			</div>
		}@if ((int)ViewData["TotalPages"] > 1)
		{
			var currentPage = (int)ViewData["CurrentPage"];
			var totalPages = (int)ViewData["TotalPages"];
			var search = ViewData["CurrentSearch"] as string ?? "";
			// Define cuántas páginas adyacentes mostrar alrededor de la actual
			var adjacentPages = 2;
			// Define el rango de inicio y fin de las páginas a mostrar
			var startPage = Math.Max(1, currentPage - adjacentPages);
			var endPage = Math.Min(totalPages, currentPage + adjacentPages);

			// Ajustamos los rangos si estamos cerca de los bordes para mantener el número de enlaces visible
			if (currentPage <= adjacentPages)
			{
				endPage = Math.Min(totalPages, 1 + (adjacentPages * 2));
			}
			if (currentPage > totalPages - adjacentPages)
			{
				startPage = Math.Max(1, totalPages - (adjacentPages * 2));
			}

			<nav aria-label="Page navigation" class="mt-4">
				<ul class="pagination justify-content-center custom-pagination">

					<li class="page-item @(currentPage == 1 ? "disabled" : "")">
						<a class="page-link" href="@Url.Action("Services", new { search = search, page = currentPage - 1 })" aria-label="Anterior">
							<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M15 18l-6-6 6-6" />
							</svg>
						</a>
					</li>

					@if (startPage > 1)
					{
						<li class="page-item"><a class="page-link" href="@Url.Action("Services", new { search = search, page = 1 })">1</a></li>
						@if (startPage > 2)
						{
							<li class="page-item disabled"><span class="page-link">...</span></li>
						}
					}

					@for (int i = startPage; i <= endPage; i++)
					{
						<li class="page-item @(i == currentPage ? "active" : "")">
							<a class="page-link" href="@Url.Action("Services", new { search = search, page = i })">@i</a>
						</li>
					}

					@if (endPage < totalPages)
					{
						@if (endPage < totalPages - 1)
						{
							<li class="page-item disabled"><span class="page-link">...</span></li>
						}
						<li class="page-item"><a class="page-link" href="@Url.Action("Services", new { search = search, page = totalPages })">@totalPages</a></li>
					}

					<li class="page-item @(currentPage == totalPages ? "disabled" : "")">
						<a class="page-link" href="@Url.Action("Services", new { search = search, page = currentPage + 1 })" aria-label="Siguiente">
							<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M9 18l6-6-6-6" />
							</svg>
						</a>
					</li>
				</ul>
			</nav>
		}
	</div>
</div>
<script>
	function filterServices() {
		const input = document.getElementById("searchInput");
		const filter = input.value.toLowerCase();
		const cards = document.querySelectorAll(".service-card");

		cards.forEach(card => {
			const name = card.dataset.name;
			const desc = card.dataset.description;
			const specialty = card.dataset.specialty;

			const match = name.includes(filter) || desc.includes(filter) || specialty.includes(filter);
			card.style.display = match ? "block" : "none";
		});
	}
</script>

